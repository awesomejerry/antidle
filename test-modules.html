<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AntIdle - æ¨¡çµ„æ¸¬è©¦</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h2 {
            color: #333;
        }
        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª AntIdle æ¨¡çµ„æ•´åˆæ¸¬è©¦</h1>
    
    <div id="test-results"></div>

    <!-- è¼‰å…¥æ‰€æœ‰è…³æœ¬ -->
    <script src="js/config.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/game-shop.js"></script>
    <script src="js/game-events.js"></script>
    <script src="js/game-achievements.js"></script>
    <script src="js/game-ui.js"></script>
    
    <script>
        const results = [];
        
        function addTest(name, passed, message) {
            results.push({ name, passed, message });
        }
        
        function runTests() {
            const container = document.getElementById('test-results');
            
            // æ¸¬è©¦ 1: æª¢æŸ¥æ‰€æœ‰æ¨¡çµ„æ˜¯å¦è¼‰å…¥
            addTest(
                'æ¨¡çµ„è¼‰å…¥æª¢æŸ¥',
                typeof GameShop !== 'undefined' && 
                typeof GameEvents !== 'undefined' && 
                typeof GameAchievements !== 'undefined' && 
                typeof GameUI !== 'undefined',
                'æ‰€æœ‰æ¨¡çµ„éƒ½å·²æ­£ç¢ºè¼‰å…¥'
            );
            
            // æ¸¬è©¦ 2: GameShop åŠŸèƒ½
            addTest(
                'GameShop - åƒ¹æ ¼è¨ˆç®—',
                typeof GameShop.getWorkerPrice === 'function' &&
                typeof GameShop.getSoldierPrice === 'function' &&
                typeof GameShop.getNursePrice === 'function',
                'GameShop åƒ¹æ ¼è¨ˆç®—å‡½æ•¸å­˜åœ¨'
            );
            
            // æ¸¬è©¦ 3: GameEvents åŠŸèƒ½
            addTest(
                'GameEvents - äº‹ä»¶è™•ç†',
                typeof GameEvents.updateWeather === 'function' &&
                typeof GameEvents.checkInvasion === 'function' &&
                typeof GameEvents.handleInvasion === 'function',
                'GameEvents äº‹ä»¶è™•ç†å‡½æ•¸å­˜åœ¨'
            );
            
            // æ¸¬è©¦ 4: GameAchievements åŠŸèƒ½
            addTest(
                'GameAchievements - æˆå°±ç³»çµ±',
                typeof GameAchievements.unlockAchievement === 'function' &&
                typeof GameAchievements.checkAchievements === 'function' &&
                typeof GameAchievements.getAchievementProgress === 'function',
                'GameAchievements æˆå°±ç³»çµ±å‡½æ•¸å­˜åœ¨'
            );
            
            // æ¸¬è©¦ 5: GameUI åŠŸèƒ½
            addTest(
                'GameUI - UI æ›´æ–°',
                typeof GameUI.updateUI === 'function' &&
                typeof GameUI.updateResources === 'function' &&
                typeof GameUI.updateButtonStates === 'function',
                'GameUI UI æ›´æ–°å‡½æ•¸å­˜åœ¨'
            );
            
            // æ¸¬è©¦ 6: Config å®Œæ•´æ€§
            addTest(
                'GameConfig - é…ç½®æª¢æŸ¥',
                typeof GameConfig !== 'undefined' &&
                typeof GameConfig.workers !== 'undefined' &&
                typeof GameConfig.soldiers !== 'undefined' &&
                typeof GameConfig.achievements !== 'undefined',
                'GameConfig é…ç½®æ­£ç¢ºè¼‰å…¥'
            );
            
            // æ¸¬è©¦ 7: Utils å·¥å…·å‡½æ•¸
            addTest(
                'Utils - å·¥å…·å‡½æ•¸',
                typeof Utils !== 'undefined' &&
                typeof Utils.formatNumber === 'function' &&
                typeof Utils.notify === 'function',
                'Utils å·¥å…·å‡½æ•¸å­˜åœ¨'
            );
            
            // æ¸¬è©¦ 8: å‡½æ•¸èª¿ç”¨æ¸¬è©¦
            try {
                const workerPrice = GameShop.getWorkerPrice();
                addTest(
                    'GameShop - å‡½æ•¸èª¿ç”¨',
                    typeof workerPrice === 'number' && workerPrice > 0,
                    `å·¥èŸ»åƒ¹æ ¼è¨ˆç®—æ­£ç¢º: ${workerPrice}`
                );
            } catch (e) {
                addTest('GameShop - å‡½æ•¸èª¿ç”¨', false, `éŒ¯èª¤: ${e.message}`);
            }
            
            // æ¸²æŸ“çµæœ
            let html = '';
            let passedCount = 0;
            let failedCount = 0;
            
            results.forEach(result => {
                const className = result.passed ? 'success' : 'error';
                const icon = result.passed ? 'âœ…' : 'âŒ';
                html += `
                    <div class="test-section">
                        <h3>${icon} ${result.name}</h3>
                        <div class="test-result ${className}">
                            ${result.message}
                        </div>
                    </div>
                `;
                if (result.passed) passedCount++;
                else failedCount++;
            });
            
            // ç¸½çµ
            html = `
                <div class="test-section">
                    <h2>æ¸¬è©¦ç¸½çµ</h2>
                    <div class="test-result info">
                        <strong>ç¸½æ¸¬è©¦æ•¸:</strong> ${results.length}<br>
                        <strong>é€šé:</strong> ${passedCount}<br>
                        <strong>å¤±æ•—:</strong> ${failedCount}<br>
                        <strong>æˆåŠŸç‡:</strong> ${((passedCount / results.length) * 100).toFixed(1)}%
                    </div>
                </div>
            ` + html;
            
            container.innerHTML = html;
        }
        
        // åŸ·è¡Œæ¸¬è©¦
        window.addEventListener('load', runTests);
    </script>
</body>
</html>
